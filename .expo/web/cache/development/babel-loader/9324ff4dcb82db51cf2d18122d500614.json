{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport $9Q8De$react, { useState as $9Q8De$useState, useImperativeHandle as $9Q8De$useImperativeHandle, Fragment as $9Q8De$Fragment } from \"react\";\nimport $9Q8De$reactdom from \"react-dom\";\nimport { VisuallyHidden as $9Q8De$VisuallyHidden } from \"@react-aria/visually-hidden\";\n\nfunction $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {\n    get: v,\n    set: s,\n    enumerable: true,\n    configurable: true\n  });\n}\n\nvar $319e236875307eab$exports = {};\n$parcel$export($319e236875307eab$exports, \"announce\", function () {\n  return $319e236875307eab$export$a9b970dcc4ae71a9;\n});\n$parcel$export($319e236875307eab$exports, \"clearAnnouncer\", function () {\n  return $319e236875307eab$export$d10ae4f68404609a;\n});\n$parcel$export($319e236875307eab$exports, \"destroyAnnouncer\", function () {\n  return $319e236875307eab$export$d8686216b8b81b2f;\n});\nvar $319e236875307eab$var$LIVEREGION_TIMEOUT_DELAY = 7000;\nvar $319e236875307eab$var$liveRegionAnnouncer = $9Q8De$react.createRef();\nvar $319e236875307eab$var$node = null;\nvar $319e236875307eab$var$messageId = 0;\n\nfunction $319e236875307eab$export$a9b970dcc4ae71a9(message) {\n  var assertiveness = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'assertive';\n  var timeout = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : $319e236875307eab$var$LIVEREGION_TIMEOUT_DELAY;\n  $319e236875307eab$var$ensureInstance(function (announcer) {\n    return announcer.announce(message, assertiveness, timeout);\n  });\n}\n\nfunction $319e236875307eab$export$d10ae4f68404609a(assertiveness) {\n  $319e236875307eab$var$ensureInstance(function (announcer) {\n    return announcer.clear(assertiveness);\n  });\n}\n\nfunction $319e236875307eab$export$d8686216b8b81b2f() {\n  if ($319e236875307eab$var$liveRegionAnnouncer.current) {\n    $9Q8De$reactdom.unmountComponentAtNode($319e236875307eab$var$node);\n    document.body.removeChild($319e236875307eab$var$node);\n    $319e236875307eab$var$node = null;\n  }\n}\n\nfunction $319e236875307eab$var$ensureInstance(callback) {\n  if (!$319e236875307eab$var$liveRegionAnnouncer.current) {\n    $319e236875307eab$var$node = document.createElement('div');\n    $319e236875307eab$var$node.dataset.liveAnnouncer = 'true';\n    document.body.prepend($319e236875307eab$var$node);\n    $9Q8De$reactdom.render($9Q8De$react.createElement($319e236875307eab$var$LiveRegionAnnouncer, {\n      ref: $319e236875307eab$var$liveRegionAnnouncer\n    }), $319e236875307eab$var$node, function () {\n      return callback($319e236875307eab$var$liveRegionAnnouncer.current);\n    });\n  } else callback($319e236875307eab$var$liveRegionAnnouncer.current);\n}\n\nvar $319e236875307eab$var$LiveRegionAnnouncer = $9Q8De$react.forwardRef(function (_, ref) {\n  var _$9Q8De$useState = $9Q8De$useState([]),\n      _$9Q8De$useState2 = _slicedToArray(_$9Q8De$useState, 2),\n      assertiveMessages = _$9Q8De$useState2[0],\n      setAssertiveMessages = _$9Q8De$useState2[1];\n\n  var _$9Q8De$useState3 = $9Q8De$useState([]),\n      _$9Q8De$useState4 = _slicedToArray(_$9Q8De$useState3, 2),\n      politeMessages = _$9Q8De$useState4[0],\n      setPoliteMessages = _$9Q8De$useState4[1];\n\n  var clear = function clear(assertiveness) {\n    if (!assertiveness || assertiveness === 'assertive') setAssertiveMessages([]);\n    if (!assertiveness || assertiveness === 'polite') setPoliteMessages([]);\n  };\n\n  var $319e236875307eab$export$a9b970dcc4ae71a9 = function $319e236875307eab$export$a9b970dcc4ae71a9(message1) {\n    var assertiveness = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'assertive';\n    var timeout = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : $319e236875307eab$var$LIVEREGION_TIMEOUT_DELAY;\n    var id = $319e236875307eab$var$messageId++;\n    if (assertiveness === 'assertive') setAssertiveMessages(function (messages) {\n      return [].concat(_toConsumableArray(messages), [{\n        id: id,\n        text: message1\n      }]);\n    });else setPoliteMessages(function (messages) {\n      return [].concat(_toConsumableArray(messages), [{\n        id: id,\n        text: message1\n      }]);\n    });\n    if (message1 !== '') setTimeout(function () {\n      if (assertiveness === 'assertive') setAssertiveMessages(function (messages) {\n        return messages.filter(function (message) {\n          return message.id !== id;\n        });\n      });else setPoliteMessages(function (messages) {\n        return messages.filter(function (message) {\n          return message.id !== id;\n        });\n      });\n    }, timeout);\n  };\n\n  $9Q8De$useImperativeHandle(ref, function () {\n    return {\n      announce: $319e236875307eab$export$a9b970dcc4ae71a9,\n      clear: clear\n    };\n  });\n  return $9Q8De$react.createElement($9Q8De$Fragment, null, $9Q8De$react.createElement($319e236875307eab$var$MessageBlock, {\n    \"aria-live\": \"assertive\"\n  }, assertiveMessages.map(function (message) {\n    return $9Q8De$react.createElement(\"div\", {\n      key: message.id\n    }, message.text);\n  })), $9Q8De$react.createElement($319e236875307eab$var$MessageBlock, {\n    \"aria-live\": \"polite\"\n  }, politeMessages.map(function (message) {\n    return $9Q8De$react.createElement(\"div\", {\n      key: message.id\n    }, message.text);\n  })));\n});\n\nfunction $319e236875307eab$var$MessageBlock(_ref) {\n  var children = _ref.children,\n      ariaLive = _ref['aria-live'];\n  return $9Q8De$react.createElement($9Q8De$VisuallyHidden, {\n    role: \"log\",\n    \"aria-live\": ariaLive,\n    \"aria-relevant\": \"additions\"\n  }, children);\n}\n\nexport { $319e236875307eab$export$a9b970dcc4ae71a9 as announce, $319e236875307eab$export$d10ae4f68404609a as clearAnnouncer, $319e236875307eab$export$d8686216b8b81b2f as destroyAnnouncer };","map":{"version":3,"sources":["packages/@react-aria/live-announcer/src/LiveAnnouncer.tsx"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport React, {Fragment, ReactNode, RefObject, useImperativeHandle, useState} from 'react';\nimport ReactDOM from 'react-dom';\nimport {VisuallyHidden} from '@react-aria/visually-hidden';\n\ntype Assertiveness = 'assertive' | 'polite';\ninterface Announcer {\n  announce(message: string, assertiveness: Assertiveness, timeout: number): void,\n  clear(assertiveness: Assertiveness): void\n}\n\n/* Inspired by https://github.com/AlmeroSteyn/react-aria-live */\nconst LIVEREGION_TIMEOUT_DELAY = 7000;\n\nlet liveRegionAnnouncer = React.createRef<Announcer>();\nlet node: HTMLElement = null;\nlet messageId = 0;\n\n/**\n * Announces the message using screen reader technology.\n */\nexport function announce(\n  message: string,\n  assertiveness: Assertiveness = 'assertive',\n  timeout = LIVEREGION_TIMEOUT_DELAY\n) {\n  ensureInstance(announcer => announcer.announce(message, assertiveness, timeout));\n}\n\n/**\n * Stops all queued announcements.\n */\nexport function clearAnnouncer(assertiveness: Assertiveness) {\n  ensureInstance(announcer => announcer.clear(assertiveness));\n}\n\n/**\n * Removes the announcer from the DOM.\n */\nexport function destroyAnnouncer() {\n  if (liveRegionAnnouncer.current) {\n    ReactDOM.unmountComponentAtNode(node);\n    document.body.removeChild(node);\n    node = null;\n  }\n}\n\n/**\n * Ensures we only have one instance of the announcer so that we don't have elements competing.\n */\nfunction ensureInstance(callback: (announcer: Announcer) => void) {\n  if (!liveRegionAnnouncer.current) {\n    node = document.createElement('div');\n    node.dataset.liveAnnouncer = 'true';\n    document.body.prepend(node);\n    ReactDOM.render(\n      <LiveRegionAnnouncer ref={liveRegionAnnouncer} />,\n      node,\n      () => callback(liveRegionAnnouncer.current)\n    );\n  } else {\n    callback(liveRegionAnnouncer.current);\n  }\n}\n\nconst LiveRegionAnnouncer = React.forwardRef((_, ref: RefObject<Announcer>) => {\n  let [assertiveMessages, setAssertiveMessages] = useState([]);\n  let [politeMessages, setPoliteMessages] = useState([]);\n\n  let clear = (assertiveness: Assertiveness) => {\n    if (!assertiveness || assertiveness === 'assertive') {\n      setAssertiveMessages([]);\n    }\n\n    if (!assertiveness || assertiveness === 'polite') {\n      setPoliteMessages([]);\n    }\n  };\n\n  let announce = (message: string, assertiveness = 'assertive', timeout = LIVEREGION_TIMEOUT_DELAY) => {\n    let id = messageId++;\n\n    if (assertiveness === 'assertive') {\n      setAssertiveMessages(messages => [...messages, {id, text: message}]);\n    } else {\n      setPoliteMessages(messages => [...messages, {id, text: message}]);\n    }\n\n    if (message !== '') {\n      setTimeout(() => {\n        if (assertiveness === 'assertive') {\n          setAssertiveMessages(messages => messages.filter(message => message.id !== id));\n        } else {\n          setPoliteMessages(messages => messages.filter(message => message.id !== id));\n        }\n      }, timeout);\n    }\n  };\n\n  useImperativeHandle(ref, () => ({\n    announce,\n    clear\n  }));\n\n  return (\n    <Fragment>\n      <MessageBlock aria-live=\"assertive\">\n        {assertiveMessages.map(message => <div key={message.id}>{message.text}</div>)}\n      </MessageBlock>\n      <MessageBlock aria-live=\"polite\">\n        {politeMessages.map(message => <div key={message.id}>{message.text}</div>)}\n      </MessageBlock>\n    </Fragment>\n  );\n});\n\ninterface MessageBlockProps {\n   children: ReactNode,\n   'aria-live': Assertiveness\n }\n\nfunction MessageBlock({children, 'aria-live': ariaLive}: MessageBlockProps) {\n  return (\n    <VisuallyHidden\n      role=\"log\"\n      aria-live={ariaLive}\n      aria-relevant=\"additions\">\n      {children}\n    </VisuallyHidden>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}